{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Course details</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="d-flex justify-content-between align-items-center p-3 bg-white shadow-sm">
    <a href="{% url 'instructor:instructor_dashboard' %}" class="text-decoration-none text-dark">
        <h3 class="m-0 fw-bold">Bildung</h3>
    </a>

    <div class="dropdown">
        <button class="btn rounded-circle shadow"
                style="background:gray;color:white;width:45px;height:45px;"
                type="button" data-bs-toggle="dropdown">
            {{ request.user.username|first|upper }}
        </button>

        <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="{% url 'instructor_profile_view' %}">Profile</a></li>
            <li><a class="dropdown-item" href="{% url 'instructor:add_course' %}">Create New Course</a></li>
            <li><a class="dropdown-item" href="{% url 'instructor:students_list' %}">My Students</a></li>
            <li><a class="dropdown-item" href="{% url 'instructor:calendar_view' %}">My Schedules</a></li>
            <li><a class="dropdown-item" href="{% url 'instructor:instructor_notifications' %}">Notifications</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="{% url 'logout_view' %}">Logout</a></li>
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div class="container py-5">

<h2 class="fw-bold mb-4 text-primary">{{ course.title }}</h2>

<div class="card shadow-sm border-0 mb-5 p-4 rounded-4">
  <h5 class="mb-3 text-secondary">Course Overview</h5>
  <p><strong>Instructor:</strong> {{ course.instructor.get_full_name|default:course.instructor.username }}</p>
  <p><strong>Price:</strong> â‚¹{{ course.price }}</p>
  <p><strong>Description:</strong></p>
  <p class="text-muted">{{ course.description }}</p>
</div>

<h3 class="fw-bold mb-4 text-primary">Course Content</h3>

{% for item in ordered_items %}

  {% if item.type == "module" %}
    <div class="card rounded-4 shadow-sm mb-4 p-4">

      <h4 class="fw-bold mb-1">
        ğŸ“˜ {{ item.title }} â€” {{ item.obj.title }}
      </h4>

      <p class="text-muted">
        {{ item.obj.description|default:"No description available." }}
      </p>

      <h6 class="fw-bold mt-3">Lectures</h6>

<div class="row g-3">
  {% if item.obj.lectures.all %}
    {% for lecture in item.obj.lectures.all %}
      <div class="col-md-3 col-sm-6">
        <div class="card h-100 shadow-sm rounded-4">

          {% if lecture.video %}
            <video controls class="w-100 rounded-top">
              <source src="{{ lecture.video.url }}" type="video/mp4">
            </video>
          {% else %}
            <img src="{% static 'images/default-video.png' %}"
                 class="img-fluid rounded-top"
                 alt="No video uploaded">
          {% endif %}

          <div class="card-body text-center">
            <h6 class="fw-bold mb-1">{{ lecture.title }}</h6>

            {% if lecture.file %}
              <a href="{{ lecture.file.url }}"
                 class="btn btn-sm btn-outline-primary mt-2"
                 download>
                ğŸ“„ Download
              </a>
            {% endif %}
          </div>

        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-muted ps-3">No lectures added.</p>
  {% endif %}
</div>

    </div>
  {% endif %}

  {% if item.type == "quiz" %}
    <div class="card shadow-sm rounded-4 mb-4 p-4 border-warning">
      <h5 class="fw-bold text-warning mb-0">
        ğŸ“ {{ item.title }}
      </h5>
    </div>
  {% endif %}

  {% if item.type == "assignment" %}
    <div class="card shadow-sm rounded-4 mb-4 p-4 border-info">
      <h5 class="fw-bold text-info mb-0">
        ğŸ“‚ {{ item.title }} â€” {{ item.obj.title }}
      </h5>
    </div>
  {% endif %}

  {% if item.type == "live" %}
    <div class="card shadow-sm rounded-4 mb-4 p-4 border-success">
      <h5 class="fw-bold text-success mb-0">
        ğŸ¥ {{ item.title }} â€” {{ item.obj.topic }}
      </h5>
    </div>
  {% endif %}

{% empty %}
  <p class="text-muted">No course content added.</p>
{% endfor %}

</div>
</body>
</html>
