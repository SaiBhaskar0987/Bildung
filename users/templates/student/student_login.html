{% extends "base.html" %}
{% load static %} 

{% block extra_css %}
<link rel="stylesheet" href="{% static 'student_login/styles.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-5"> <!-- Main container -->
  <div class="row justify-content-center"> <!-- Centered row -->
    <div class="col-md-6"> <!-- Centered column -->
      <div class="card shadow p-4"> <!-- Card for login form -->
        <h2 class="text-center mb-4">Student Login</h2> <!-- Heading -->

        {% if messages %}
        <div aria-live="polite" aria-atomic="true" class="position-relative"> <!-- Toast container -->
          <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;"> <!-- Toasts position -->
            {% for message in messages %}
              <div class="toast align-items-center text-white bg-{{ message.tags }} border-0" 
                   role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000">
                <div class="d-flex">
                  <div class="toast-body">
                    {{ message }}
                  </div> <!-- Toast body -->
                  <button type="button"
                          class="btn-close btn-close-white me-2 m-auto"
                          data-bs-dismiss="toast"></button>
                </div> <!-- Toast flex container -->
              </div> <!-- Single toast -->
            {% endfor %}
          </div> <!-- Toasts position -->
        </div> <!-- Toast container -->
        {% endif %}

        {% if form.non_field_errors %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
          {% for error in form.non_field_errors %}
            {{ error }}
          {% endfor %}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div> <!-- Non-field errors alert -->
        {% endif %}

        <form method="post" novalidate>
          {% csrf_token %}

          <div class="mb-3"> 
            <label for="{{ form.username.id_for_label }}" class="form-label">
              Email or Username
            </label>
            {{ form.username }}
          </div><!-- Username/Email Field -->

          <div class="mb-3"> 
            <label for="{{ form.password.id_for_label }}" class="form-label">
              Password
            </label>
            {{ form.password }}
          </div> <!-- Password Field -->

          <button type="submit" class="btn btn-success w-100 py-2">
            Login
          </button> <!-- Submit Button -->
        </form> <!-- Login Form -->

        <p class="mt-3 text-center">
          <a href="{% url 'forgot_password' %}">Forgot Password?</a>
        </p> <!-- Forgot Password Link -->

        <p class="text-center mb-0">
          Don't have an account?
          <a href="{% url 'student_signup' %}" class="fw-bold">
            Student Signup
          </a>
        </p> <!-- Signup Link -->
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('.toast').forEach(function (toastEl) {
    new bootstrap.Toast(toastEl).show();
  });
});
</script>
{% endblock %}
